<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AITA â€” Cast Your Judgment</title>

    <!-- Open Graph for link previews -->
    <meta property="og:title" content="AITA â€” Judge Real-Life Conflicts">
    <meta property="og:description" content="Cast your vote on this case. Who's wrong here?">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aitaapp.link">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Supabase JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

    <style>
        /* â”€â”€ Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;0,9..40,800&display=swap');

        :root {
            --gradient-top: #D946EF;
            --gradient-mid: #EC4899;
            --gradient-bottom: #F97316;
            --purple-brand: #7C3AED;
            --purple-light: #A78BFA;
        }

        html, body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-font-smoothing: antialiased;
            min-height: 100dvh;
            background: linear-gradient(175deg, var(--gradient-top) 0%, var(--gradient-mid) 35%, var(--gradient-bottom) 100%);
            overflow-x: hidden;
        }

        /* â”€â”€ Skeleton Loader â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite ease-in-out;
            border-radius: 8px;
        }
        @keyframes shimmer {
            0%   { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* â”€â”€ Vote option styling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .vote-option {
            border: 2px solid #E5E7EB;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        .vote-option:hover {
            border-color: #D1D5DB;
            background: #FAFAFA;
        }
        .vote-option:active {
            transform: scale(0.97);
        }
        .vote-option.selected {
            border-color: var(--purple-brand);
            background: rgba(124, 58, 237, 0.04);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.15);
        }

        /* â”€â”€ Submit button â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .btn-submit {
            background: linear-gradient(135deg, #7C3AED, #8B5CF6, #A78BFA);
            transition: all 0.25s ease;
        }
        .btn-submit:disabled {
            background: #E5E7EB;
            color: #9CA3AF;
            cursor: not-allowed;
            box-shadow: none;
        }
        .btn-submit:not(:disabled):hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4);
        }
        .btn-submit:not(:disabled):active {
            transform: translateY(0);
        }

        /* â”€â”€ CTA download button â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .btn-download {
            background: #111827;
            transition: all 0.2s ease;
        }
        .btn-download:hover {
            background: #1F2937;
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }
        .btn-download:active {
            transform: translateY(0);
        }

        /* â”€â”€ Result bars â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .result-bar-fill {
            transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* â”€â”€ Fade-in animation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .fade-in {
            animation: fadeIn 0.4s ease forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* â”€â”€ Card subtle entrance â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .card-enter {
            animation: cardSlideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @keyframes cardSlideUp {
            from { opacity: 0; transform: translateY(30px); }
            to   { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<!-- ================================================================ -->
<!-- MAIN CONTAINER                                                    -->
<!-- ================================================================ -->
<div id="app" class="flex flex-col items-center min-h-dvh px-4 py-8 pb-12">

    <!-- â”€â”€ LOADING STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="loading-state" class="w-full max-w-md mt-8">
        <div class="bg-white rounded-3xl p-6 shadow-xl">
            <!-- Avatar skeleton -->
            <div class="flex items-center gap-3 mb-6 pb-4 border-b border-gray-100">
                <div class="skeleton w-11 h-11 rounded-full shrink-0"></div>
                <div class="flex flex-col gap-2">
                    <div class="skeleton w-24 h-3"></div>
                    <div class="skeleton w-36 h-4"></div>
                </div>
            </div>
            <!-- Title skeleton -->
            <div class="skeleton w-full h-6 mb-3"></div>
            <div class="skeleton w-3/4 h-6 mb-6"></div>
            <!-- Body skeleton -->
            <div class="skeleton w-full h-4 mb-2"></div>
            <div class="skeleton w-full h-4 mb-2"></div>
            <div class="skeleton w-5/6 h-4 mb-2"></div>
            <div class="skeleton w-full h-4 mb-2"></div>
            <div class="skeleton w-2/3 h-4 mb-8"></div>
            <!-- Vote button skeletons -->
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="skeleton h-24 rounded-2xl"></div>
                <div class="skeleton h-24 rounded-2xl"></div>
                <div class="skeleton h-24 rounded-2xl"></div>
                <div class="skeleton h-24 rounded-2xl"></div>
            </div>
            <div class="skeleton w-full h-14 rounded-2xl"></div>
        </div>
    </div>

    <!-- â”€â”€ CASE CARD (hidden until loaded) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="case-card" class="w-full max-w-md mt-6 hidden">
        <div class="bg-white rounded-3xl shadow-2xl overflow-hidden card-enter">

            <!-- Header bar -->
            <div class="flex items-center gap-3 px-6 pt-6 pb-4 border-b border-gray-100">
                <div class="w-11 h-11 bg-gray-200 rounded-full flex items-center justify-center shrink-0">
                    <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 12c2.7 0 4.8-2.1 4.8-4.8S14.7 2.4 12 2.4 7.2 4.5 7.2 7.2 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.4h19.2v-2.4c0-3.2-6.4-4.8-9.6-4.8z"/>
                    </svg>
                </div>
                <div>
                    <p class="text-sm text-gray-400 font-medium leading-tight">@anonymous</p>
                    <p class="text-base font-bold text-gray-800 leading-tight">cast your judgment!</p>
                </div>
            </div>

            <!-- Case content -->
            <div class="px-6 pt-5 pb-6">
                <!-- Title -->
                <h1 id="case-title" class="text-xl font-extrabold text-gray-900 leading-snug mb-4"></h1>

                <!-- Body / Story -->
                <p id="case-body" class="text-base text-gray-500 leading-relaxed mb-6" style="white-space: pre-line;"></p>

                <!-- â”€â”€ VOTING SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <div id="vote-section">
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="vote-option flex flex-col items-center justify-center py-5 px-3"
                             data-vote="yta" onclick="selectVote('yta')">
                            <span class="text-3xl mb-1.5">ğŸš«</span>
                            <span class="text-sm font-bold text-gray-700">You're Wrong</span>
                        </div>
                        <div class="vote-option flex flex-col items-center justify-center py-5 px-3"
                             data-vote="nta" onclick="selectVote('nta')">
                            <span class="text-3xl mb-1.5">âŒ</span>
                            <span class="text-sm font-bold text-gray-700">They're Wrong</span>
                        </div>
                        <div class="vote-option flex flex-col items-center justify-center py-5 px-3"
                             data-vote="esh" onclick="selectVote('esh')">
                            <span class="text-3xl mb-1.5">ğŸ’¥</span>
                            <span class="text-sm font-bold text-gray-700">Everyone Sucks</span>
                        </div>
                        <div class="vote-option flex flex-col items-center justify-center py-5 px-3"
                             data-vote="nah" onclick="selectVote('nah')">
                            <span class="text-3xl mb-1.5">â˜‘ï¸</span>
                            <span class="text-sm font-bold text-gray-700">No One Sucks</span>
                        </div>
                    </div>

                    <button id="submit-btn" class="btn-submit w-full py-4 rounded-2xl text-white font-bold text-lg tracking-wide disabled:opacity-100"
                            disabled onclick="submitVote()">
                        Submit Vote
                    </button>
                </div>

                <!-- â”€â”€ RESULTS SECTION (hidden until voted) â”€â”€ -->
                <div id="results-section" class="hidden fade-in">
                    <div class="text-center mb-6">
                        <p class="text-lg font-bold text-green-600 mb-1">âœ“ Vote submitted!</p>
                        <p class="text-sm text-gray-400">Thanks for casting your judgment</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- â”€â”€ ANONYM JUDGMENT link â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="text-center mt-5">
            <a href="#" class="text-sm font-semibold text-white/80 underline underline-offset-4 decoration-white/40 hover:text-white transition-colors">
                anonym judgment
            </a>
        </div>

        <!-- â”€â”€ SOCIAL PROOF counter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="vote-counter" class="text-center mt-10 hidden">
            <p class="text-lg font-bold text-white">
                ğŸ‘‡ <span id="total-votes-display">0</span> people have judged this case ğŸ‘‡
            </p>
        </div>

        <!-- â”€â”€ CTA: Download App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="mt-6 w-full">
            <a id="download-btn" href="https://apps.apple.com/app/aita/id0000000000"
               class="btn-download block w-full py-4 rounded-full text-white font-bold text-lg text-center tracking-wide">
                Share Your Own Story!
            </a>
        </div>

        <!-- â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="flex items-center justify-center gap-6 mt-6 pb-4">
            <a href="#" class="text-sm text-white/60 hover:text-white/90 transition-colors">Terms</a>
            <a href="#" class="text-sm text-white/60 hover:text-white/90 transition-colors">Privacy</a>
        </div>
    </div>

    <!-- â”€â”€ ERROR STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="error-state" class="w-full max-w-md mt-16 text-center hidden">
        <div class="bg-white/10 backdrop-blur-sm rounded-3xl p-8">
            <p class="text-5xl mb-4">âš–ï¸</p>
            <h2 class="text-xl font-bold text-white mb-2">Case Not Found</h2>
            <p class="text-white/70 mb-8 text-sm leading-relaxed">This case may have been removed or the link is invalid. But you can still judge real-life conflicts in the app!</p>
            <a href="https://apps.apple.com/app/aita/id0000000000"
               class="btn-download inline-block px-8 py-4 rounded-full text-white font-bold text-lg">
                Download AITA
            </a>
        </div>
    </div>

</div>


<!-- ================================================================ -->
<!-- JAVASCRIPT                                                        -->
<!-- ================================================================ -->
<script>
// â”€â”€â”€ CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Replace these with your actual Supabase project credentials
const SUPABASE_URL  = 'https://mnebpvhyjlasnwnmhuxm.supabase.co';
const SUPABASE_ANON = 'sb_publishable_m81YwqXOF5DjNh0ker0WZw_2g_jtwyi';

const APP_STORE_URL = 'https://apps.apple.com/us/app/aita-whos-right/id6758395005'; // Replace with real URL

// â”€â”€â”€ INIT SUPABASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentCaseId  = null;
let selectedVote   = null;
let isSubmitting   = false;

// â”€â”€â”€ DOM REFS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const $loading     = document.getElementById('loading-state');
const $caseCard    = document.getElementById('case-card');
const $errorState  = document.getElementById('error-state');
const $title       = document.getElementById('case-title');
const $body        = document.getElementById('case-body');
const $voteSection = document.getElementById('vote-section');
const $results     = document.getElementById('results-section');
const $submitBtn   = document.getElementById('submit-btn');
const $voteCounter = document.getElementById('vote-counter');
const $totalVotes  = document.getElementById('total-votes-display');

// â”€â”€â”€ ON PAGE LOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', init);

async function init() {
    // Update all download links
    document.querySelectorAll('a[href*="apps.apple.com"]').forEach(a => {
        a.href = APP_STORE_URL;
    });

    // Parse case ID from URL
    const params = new URLSearchParams(window.location.search);
    currentCaseId = params.get('id');

    if (!currentCaseId) {
        showError();
        return;
    }

    try {
        await loadCase(currentCaseId);
    } catch (err) {
        console.error('Failed to load case:', err);
        showError();
    }
}

// â”€â”€â”€ LOAD CASE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadCase(caseId) {
    // Fetch the case data
    const { data: caseData, error: caseError } = await supabaseClient
        .from('cases')
        .select('id, case_number, title, snippet, full_story, category')
        .eq('id', caseId)
        .single();

    if (caseError || !caseData) {
        showError();
        return;
    }

    // Fetch combined vote stats
    const { data: stats } = await supabaseClient
        .from('combined_vote_stats')
        .select('*')
        .eq('case_id', caseId)
        .single();

    // Populate the UI
    $title.textContent = caseData.title;
    $body.textContent  = caseData.full_story || caseData.snippet;

    const totalVotes = stats ? stats.total_votes : 0;
    $totalVotes.textContent = totalVotes.toLocaleString();

    // Check if user already voted (localStorage)
    const storageKey = `aita_voted_${caseId}`;
    const previousVote = localStorage.getItem(storageKey);

    if (previousVote && stats) {
        // Already voted â€” show results directly
        showResults(stats, previousVote);
    }

    // Show the card, hide loading
    $loading.classList.add('hidden');
    $caseCard.classList.remove('hidden');
    $voteCounter.classList.remove('hidden');
}

// â”€â”€â”€ SELECT A VOTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function selectVote(voteType) {
    if (isSubmitting) return;

    selectedVote = voteType;

    // Update UI selection
    document.querySelectorAll('.vote-option').forEach(el => {
        el.classList.toggle('selected', el.dataset.vote === voteType);
    });

    // Enable submit button
    $submitBtn.disabled = false;
}

// â”€â”€â”€ SUBMIT VOTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function submitVote() {
    if (!selectedVote || !currentCaseId || isSubmitting) return;

    isSubmitting = true;
    $submitBtn.disabled = true;
    $submitBtn.textContent = 'Submitting...';

    try {
        // Call the RPC function
        const { data, error } = await supabaseClient.rpc('vote_on_case_web', {
            p_case_id:   currentCaseId,
            p_vote_type: selectedVote
        });

        if (error) throw error;
        if (data && !data.success) throw new Error(data.error);

        // Save to localStorage to prevent re-voting
        localStorage.setItem(`aita_voted_${currentCaseId}`, selectedVote);

        // Show results
        showResults(data, selectedVote);

        // Update total counter
        if (data && data.total_votes) {
            $totalVotes.textContent = data.total_votes.toLocaleString();
        }

    } catch (err) {
        console.error('Vote failed:', err);
        $submitBtn.textContent = 'Try Again';
        $submitBtn.disabled = false;
        isSubmitting = false;
    }
}

// â”€â”€â”€ SHOW RESULTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showResults(stats, userVote) {
    // Normalize keys â€” handle both RPC response and view query
    const yw  = stats.youre_wrong     || stats.youre_wrong_count     || 0;
    const tw  = stats.theyre_wrong    || stats.theyre_wrong_count    || 0;
    const es  = stats.everyone_sucks  || stats.everyone_sucks_count  || 0;
    const nos = stats.no_one_sucks    || stats.no_one_sucks_count    || 0;
    const total = yw + tw + es + nos || 1; // avoid division by zero

    const results = [
        { key: 'yta', label: "You're Wrong",    emoji: 'ğŸš«', count: yw,  color: '#EF4444', bg: '#FEE2E2' },
        { key: 'nta', label: "They're Wrong",   emoji: 'âŒ', count: tw,  color: '#F59E0B', bg: '#FEF3C7' },
        { key: 'esh', label: 'Everyone Sucks',  emoji: 'ğŸ’¥', count: es,  color: '#8B5CF6', bg: '#EDE9FE' },
        { key: 'nah', label: 'No One Sucks',    emoji: 'â˜‘ï¸', count: nos, color: '#10B981', bg: '#D1FAE5' },
    ];

    // Sort by count descending
    results.sort((a, b) => b.count - a.count);

    // Build result bars
    let html = '';
    results.forEach((r, i) => {
        const pct = Math.round((r.count / total) * 100);
        const isUserVote = r.key === userVote;
        const delay = i * 100;

        html += `
        <div class="mb-3 ${isUserVote ? 'ring-2 ring-offset-2 rounded-xl' : ''}"
             style="${isUserVote ? `ring-color: ${r.color};` : ''}">
            <div class="flex items-center justify-between mb-1.5 px-1">
                <span class="text-sm font-semibold text-gray-700">
                    ${r.emoji} ${r.label} ${isUserVote ? '<span class="text-xs text-gray-400 ml-1">(your vote)</span>' : ''}
                </span>
                <span class="text-sm font-bold" style="color: ${r.color}">${pct}%</span>
            </div>
            <div class="w-full h-3 rounded-full overflow-hidden" style="background: ${r.bg}">
                <div class="result-bar-fill h-full rounded-full" 
                     style="width: 0%; background: ${r.color}; animation-delay: ${delay}ms;"
                     data-width="${pct}%">
                </div>
            </div>
        </div>`;
    });

    // Hide vote buttons, show results
    $voteSection.classList.add('hidden');
    $results.innerHTML = `
        <div class="text-center mb-6">
            <p class="text-lg font-bold text-green-600 mb-1">âœ“ Vote submitted!</p>
            <p class="text-sm text-gray-400">Thanks for casting your judgment</p>
        </div>
        ${html}
    `;
    $results.classList.remove('hidden');

    // Animate bars after a short delay
    requestAnimationFrame(() => {
        setTimeout(() => {
            document.querySelectorAll('.result-bar-fill').forEach(bar => {
                bar.style.width = bar.dataset.width;
            });
        }, 150);
    });

    // Update total
    $totalVotes.textContent = total.toLocaleString();
    $voteCounter.classList.remove('hidden');
}

// â”€â”€â”€ SHOW ERROR STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showError() {
    $loading.classList.add('hidden');
    $caseCard.classList.add('hidden');
    $errorState.classList.remove('hidden');
}
</script>

</body>
</html>
